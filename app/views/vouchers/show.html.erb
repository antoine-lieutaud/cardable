<% ending_date = @voucher.created_at + @voucher.offer.validity.months %>

   <% if ending_date < Date.today %>
      <% voucher_status = 'périmé' %>
      <% voucher_color = '#102E4E' %>
   <% elsif @voucher.limit_use - @voucher.nb_redeems == 0 %>
      <% voucher_status = 'consommé' %>
   <% else %>
      <% voucher_status = 'VALIDE'%>
   <% end %>

<% if @voucher.limit_use - @voucher.nb_redeems.to_i > 0 %>
  <div class="container-voucher-info">
    <div class="redeem-circle mt-3"><%= "#{@voucher.limit_use - @voucher.nb_redeems}" %></div>
    <p class="text-center mb-4", style="font-size:24px"> Utilisations restantes</p>
    <%= link_to 'Utiliser', voucher_redeems_path(@voucher), method: :post, class: "btn-redeem mb-5" %>
    <div class="container-voucher-details">
      <p class="text-center mb-2"><%= "Statut : "%><span style="color: <%= voucher_color %>"><%="#{voucher_status}"%></span></p>
      <p class="text-center mb-2"><%= "Fin validité : #{(@voucher.created_at + @voucher.offer.validity.months).to_s.split.first}" %></p>
      <p class="text-center mb-2"><%= "Offre : #{@voucher.offer.name}" %></p>
      <p class="text-center mb-2"><%= "Utilisations restantes : #{@voucher.limit_use - @voucher.nb_redeems} / #{@voucher.limit_use}" %></p>
    </div>
    <div id="sweet-alert-demo" class="btn btn-danger">Utiliser</div>
     <%= link_to 'Utiliser', voucher_redeems_path(@voucher), method: :post, id: "vouchersummit", class: "d-none" %>
    </div>
<% else %>
  <div class="container-voucher-info">
    <p class="text-center mb-2"><%= "Utilisations restantes : #{@voucher.limit_use - @voucher.nb_redeems.to_i}" %></p>
    <p class="text-center mb-2"><%= "Offre : #{@voucher.offer.name}" %></p>
    <p class="text-center mb-2"><%= "Prix Total : #{@voucher.final_price}€" %></p>
    <p class="text-center mb-2"><%= "Période de validité : #{@voucher.offer.validity} mois" %></p>
    <p class="text-center mb-2"><%= "A partir du : #{@voucher.created_at}" %></p>
    <p class="text-center mb-2"><%= "Fin validité : #{@voucher.created_at + @voucher.offer.validity.months}" %></p>
    <p class="text-center mb-2"><%= "Status : #{voucher_status}" %></p>
  </div>
<% end %>

<%# <div class= "qrcode"> %>
  <%#= @voucher.qr_code.html_safe %>
 <%# </div> %>
<% content_for :back_link do %>
  <a href="<%= root_path %>">
    <div class="btn-footer">
      <%= image_tag 'return.png',class:"btn-footer__icon" %>
    </div>
  </a>
<% end %>
